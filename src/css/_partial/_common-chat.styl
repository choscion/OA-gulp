chat-secondary = #f2f3f5
chat-success = #d1dcf5
chat-primary = #b8ebb8

active-primary = mix(#fff, #00b900, 32%)
active-secondary = mix(#000, #cfd4da, 8%)
active-success = mix(#fff, #5b82db, 32%)


// Chat Message : Style patch for koromo
.chat-item-active
  .chat-item.baloon
    background: active-secondary !important
    &:after
      border-right-color: active-secondary !important
    .chat-reverse &
      &:after
        border-right-color: transparent !important;
        border-left-color: active-secondary !important;
    .chat-primary &
      background: active-primary !important
      &:after
        border-right-color: active-primary !important
    .chat-primary.chat-reverse &
      &:after
        border-left-color: active-primary !important;
    .chat-success &
      background: active-success !important
      &:after
        border-right-color: active-success !important
    .chat-success.chat-reverse &
      &:after
        border-left-color: active-success !important;

.chat-item.image
  .chat-media-link::after
    content ''
    display block
    position absolute
    left 0
    top 0
    width 100%
    height 100%
    border-radius inherit
    background-color rgba(#000, 0.2)
    opacity 0
    visibility hidden
    transition all .15s linear;
  .chat-item-active
    .chat-media-link::after
      opacity 1
      visibility visible

.chat-item-active
  .chat-item.image
    .chat-media-link::after
      opacity 1
      visibility visible

.chat-item-template-main
  width auto !important
  max-width 320px


// Selection
.chat-content
  width 100%
  min-width 0
  display flex
  flex-wrap wrap
  flex-direction column

  .chat-body
    max-width 100%
    width 100%

.hide-selection ::selection
  background-color transparent

// Flex(rich) msg
.chat-body
  &.rich
    width intrinsic
    width -webkit-fit-content
    width fit-content
    max-width 100%
    .chat-reverse &
      margin-left auto

// Multiple image view
.chat-body
  .chat-item.multi
    overflow visible
    max-width 200px
    display grid
    grid-template-columns 1fr 1fr
    grid-gap 1px
    gap 1px
    background-color #fff!important

    & > div
      position relative
      float left // grid fallback
      width 100px
      height 100px
      &:last-child:nth-child(odd)
        grid-column span 2
        width auto
      &:only-child
        width 12.5rem!important
        height 8.75rem!important
      &:nth-child(1)
        .chat-media-link,
        .chat-item-file,
        .chat-media-progress
          border-top-left-radius 0.5rem
      &:nth-child(2)
        .chat-media-link,
        .chat-item-file,
        .chat-media-progress
          border-top-right-radius 0.5rem
      &:nth-last-child(1)
        .chat-media-link,
        .chat-item-file,
        .chat-media-progress
          border-bottom-right-radius 0.5rem
      &:nth-last-child(2):nth-child(odd)
        .chat-media-link,
        .chat-item-file,
        .chat-media-progress
          border-bottom-left-radius 0.5rem
      &:last-child:nth-child(odd)
        .chat-media-link,
        .chat-item-file,
        .chat-media-progress
          border-bottom-left-radius 0.5rem
          border-bottom-right-radius 0.5rem

    img
      object-fit cover
      width 100%
      height 100%

    .chat-item-file
      width 100%!important
      height 100%!important
      .loader, .loader:after
        width 1.5rem
        height 1.5rem
      .chat-primary &
        background-color chat-primary!important
      .chat-secondary &
        background-color chat-secondary!important
      .chat-success &
        background-color chat-success!important

// Pinned messages
.chat-pinned
  top 0
  left 0
  right 0
  z-index 2
  &.open
    .list-group-item
      display block
    .list-toggle
      transform rotate(180deg)
  .list-group-item
    display none
    height 3.75rem
    &:first-child
      display block
  .list-toggle
    top 0.25rem
    right 0
    z-index 1

// Sticky chatroom avatar
.chat .avatar.position-sticky
  top 0

// Focused chat after search & clicking Reply input UI
.chat-body.focus
  .chat-item
    animation shake 0.82s cubic-bezier(.36,.07,.19,.97) both infinite;
    backface-visibility hidden
    transform translate3d(0, 0, 0);

// Focused multi Image chat after clicking Reply input UI
.chat-body
  .chat-item.image.multi
    .focus
      animation shake 0.82s cubic-bezier(.36,.07,.19,.97) both infinite;
      backface-visibility hidden
      transform translate3d(0, 0, 0);

@keyframes shake {
  0%, 20%, 40%, 60%, 80%, 100% {transform: translate3d(-1px, 0, 0);}
  10%, 30%, 50%, 70%, 90% {transform: translate3d(-4px, 0, 0);}
}

// Message / Custom sticker
.chat-item-sticker-overlay
  position absolute
  top 0
  left 0
  width 100%
  height 100%

// Chat image by aspect ratio
.chat-item.image.portrait
  img
    width auto
    min-width 64px
    height 274px
    object-fit cover

.chat-item.image.landscape
  img
    height 81px
    object-fit cover

// Media
.chat-item.image,
.chat-item.video
  border-radius 0.5rem
  overflow hidden

// Unsent
.chat-body.unsent
  .chat-main
    .chat-item
      background-color #fff!important
      opacity 0.4

      &.baloon,
      &.rounded
        border 1px solid #c6c8ca
        color #868e96!important
      &.baloon
        &::before
          content: '';
          position: absolute;
          top: 0.7rem;
          left: auto;
          right: -0.125rem;
          border: 0.55rem solid transparent;
          border-left-color: #c6c8ca;
          border-right: 0;
          border-top: 0;
          margin-right: -0.375rem;
          margin-left: -0.375rem;
        &::after
          border-left-color #fff!important
      .chat-item-link-body
        border-left-color #c6c8ca!important;

    .las, .lar, .fas, .far
      color #868e96!important

    &.chat-item-active
      .chat-item
        background-color active-secondary!important
        &.baloon
          &::after
            border-left-color active-secondary!important

  .chat-sub
      &::before
        display inline-block
        text-align right
        font-family laicon-solid!important
        content "\e070"
        color #868e96
        font-size 0.875rem

// Typing status spinner
.chat-footer
  .text-pre
    line-height 1.5
.chat-item.rounded-circle
  border-radius 1rem!important
.chat-item-loading
  padding 0 0.75rem
  font-size 1.40625rem
.spinner-grow-custom,
.spinner-grow-custom::before,
.spinner-grow-custom::after
    width: 0.1875em;
    height: 0.1875em;
    border-radius: 50%;
    background-color rgba(#adb5bd, 0.3)
    -webkit-animation-fill-mode: both;
    animation-fill-mode: both;
    -webkit-animation spinner 1.2s infinite ease-in-out;
    animation spinner 1.2s infinite ease-in-out;
    .chat-item-loading &
      width 0.25em
      height 0.25em
.spinner-grow-custom
  display inline-block
  position relative
  margin-right 0.7em
  font-size 16px
  -webkit-transform translateZ(0)
  transform translateZ(0)
  vertical-align middle
  .chat-item-loading &
    margin-right 0.9em
    font-size inherit
  &::before,
  &::after
    content: '';
    position absolute
    display inline-block
  &::before
    left 0.3125em
    animation-delay 0.4s
    .chat-item-loading &
      left 0.4em
  &::after
    left: 0.6250em
    animation-delay 0.8s
    .chat-item-loading &
      left 0.8em

@keyframes spinner {
  0% {
    background-color rgba(#adb5bd, 0.3)
  }
  50% {
    background-color rgba(#adb5bd, 1)
  }
  100% {
    background-color rgba(#adb5bd, 0.3)
  }
}

// Flex message preview
.chat-item-template-footer
  .link
    display flex
    justify-content space-between
    align-items center
    border-top 1px solid rgba(173,181,189,0.5)
    padding 0.5rem;




// Chatroom : Message over inputform
.frontdrop
  display flex
  align-items center
  justify-content center
  position absolute
  top 0
  left 0
  width 100%
  height 100%
  color #fff
  text-align center
  z-index 1

// Chatroom : Multi image progress
.chat-media-progress
  top 0
  left 0
  &:before
    position absolute
    top 0
    left 0
    width 100%
    height 100%
    background rgba(0,0,0,0.2)
    content ''
  .circle
    width 1.75rem
    height 1.75rem
    border 0.0625rem solid transparent
    border-radius 50%
    background rgba(0,0,0,0.1)
    box-sizing content-box
    &:after
      border-width 0.125rem
      border-color rgba(255,255,255,0.5)
    .circle-left
    .circle-right
      &:after
        border-width 0.125rem
        transition transform 200ms linear
    .circle-left
      &:after
        transition-delay 200ms

// Chatroom : Style in which banners are hidden
.chatroom-banner
  z-index 3
  transform translateY(-110%)
  transition transform .25s ease
  &.active
    transform translateY(0)